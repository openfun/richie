{% load i18n cms_tags %}{% spaceless %}

{% with variant=variant|default:"default" %}

{% comment %}Accordion variant to make first level container, always turn to
an "accordion_item" variant for second level.{% endcomment %}
{% if variant == "accordion" %}
    <div class="nesteditem nesteditem--{{ variant }}">
        {% if instance.content %}
            <h{{ header_level|default:2 }} class="nesteditem__head">
                {{ instance.content|linebreaksbr }}
            </h{{ header_level|default:2 }}>
        {% endif %}
        {% if instance.child_plugin_instances %}
        <div class="nesteditem__items">
            {% for plugin in instance.child_plugin_instances %}
                {% with variant="accordion_item" %}
                    <div class="nesteditem__item" data-accordion-item>
                    {% render_plugin plugin %}
                    </div>
                {% endwith %}
            {% endfor %}
        </div>
        {% endif %}
    </div>
{% comment %}Accordion item, used automatically from "accordion" variant, this
is for folding item. It is not intended to be used "manually". Items will be
turned as a simple list using "list" variant.{% endcomment %}
{% elif variant == "accordion_item" %}
    {% if instance.content %}
        <button class="nesteditem__item-title" data-accordion-title>
            {{ instance.content }}
        </button>
    {% else %}
        <button class="nesteditem__item-title" data-accordion-title>
            {% trans 'Accordion item need a content' %}
        </button>
    {% endif %}
    {% if instance.child_plugin_instances %}
    <div class="nesteditem__item-content" data-accordion-content>
        <ul>
        {% for plugin in instance.child_plugin_instances %}
            <li>
            {% with variant="list" %}
                {% render_plugin plugin %}
            {% endwith %}
            </li>
        {% endfor %}
        </ul>
    </div>
    {% endif %}
{% comment %}List variant just turns every items into a simple bullet list{% endcomment %}
{% elif variant == "list" %}
    <div class="nesteditem nesteditem--{{ variant }}">
        {% if instance.content %}
        <div class="nesteditem__content">
            {{ instance.content|linebreaksbr }}
        </div>
        {% endif %}

        {% if instance.child_plugin_instances %}
        <ul class="nesteditem__items">
            <li>
            {% for plugin in instance.child_plugin_instances %}
                {% render_plugin plugin %}
            {% endfor %}
            </li>
        </ul>
        {% endif %}
    </div>
{% comment %}Default variant, default layout displays it as an horizontal menu{% endcomment %}
{% else %}
    <div class="nesteditem nesteditem--{{ variant }}">
        {% if instance.content %}
        <div class="nesteditem__content">
            {{ instance.content|linebreaks }}
        </div>
        {% endif %}

        {% if instance.child_plugin_instances %}
        <div class="nesteditem__items">
            {% for plugin in instance.child_plugin_instances %}
                {% render_plugin plugin %}
            {% endfor %}
        </div>
        {% endif %}
    </div>
{% endif %}

{% endwith %}
{% endspaceless %}
